# 🎓 教師功能文檔 - 三個新增功能

## 📋 概述

已新增三個強大的教師功能，幫助教師更有效地管理課程和成績：

| 功能 | 路由 | 描述 |
|------|------|------|
| **1️⃣ 新增課程** | `/teacher/add_course/` | 教師可以快速建立自己的課程 |
| **2️⃣ 查詢修課學生名單** | `/teacher/student_list/` | 查看所有修課學生，支持按課程篩選 |
| **3️⃣ 給學生期中、期末分數** | `/teacher/grade_entry/` | 便捷的成績批量輸入介面 |

---

## 🚀 功能 1: 新增課程

### 訪問方式

**方式一：從教師儀表板**
1. 登入教師帳號 (例: `teacher1` / `teacher123`)
2. 點擊教師儀表板上的「➕ 新增課程」按鈕

**方式二：直接訪問**
```
http://127.0.0.1:8000/teacher/add_course/
```

### 功能說明

允許教師建立新課程，並自動將該教師指派為課程授課教師。

### 表單欄位

| 欄位 | 類型 | 必需 | 說明 |
|------|------|------|------|
| 課程名稱 | 文本輸入 | ✅ | 課程的完整名稱 (例: Python 程式設計) |
| 課程代碼 | 文本輸入 | ✅ | 唯一識別碼，必須全系統唯一 (例: CS101) |
| 課程描述 | 長文本 | ❌ | 課程內容簡介，方便學生了解 |

### 使用步驟

```
1. 點擊「➕ 新增課程」按鈕
   ↓
2. 填寫課程名稱 (必須)
   ↓
3. 填寫課程代碼 (必須，唯一)
   ↓
4. (可選) 填寫課程描述
   ↓
5. 點擊「新增課程」按鈕
   ↓
6. 自動返回教師儀表板
   ↓
7. 新課程出現在「我的課程」列表中 ✅
```

### 建立範例

```
課程名稱: Web 開發基礎
課程代碼: CS201
課程描述: 學習 HTML、CSS 和 JavaScript 的基礎知識，
        建立響應式網站，了解前端開發工作流程。
```

### 課程代碼命名建議

```
資訊系:        CS101, CS102, CS201, CS202, CS301, CS302...
數學系:        MATH101, MATH102, MATH201, MATH301...
英文系:        ENG101, ENG102, ENG201, ENG301...
通識教育:      GE101, GE102, GE103...
```

### 驗證規則

- ✅ 課程名稱: 1-200 字符
- ✅ 課程代碼: 1-50 字符，全系統唯一
- ✅ 課程描述: 最多 2000 字符

---

## 👥 功能 2: 查詢修課學生名單

### 訪問方式

**方式一：從教師儀表板**
1. 點擊教師儀表板上的「👥 查詢修課學生」按鈕

**方式二：直接訪問**
```
http://127.0.0.1:8000/teacher/student_list/
```

### 功能說明

查看所有修課學生的詳細信息，包括：
- 學生名稱和學號
- 所修課程
- 期中、期末分數
- 平均分數

支持按課程篩選，查看特定課程的修課學生。

### 表單欄位

| 欄位 | 類型 | 說明 |
|------|------|------|
| 篩選課程 | 下拉選單 | 選擇特定課程查看該課程的學生，「查看所有課程」顯示全部 |

### 使用步驟

#### 查看所有課程的修課學生

```
1. 訪問「查詢修課學生名單」頁面
   ↓
2. 選擇「-- 查看所有課程 --」(預設)
   ↓
3. 表格顯示所有課程的所有修課學生 ✅
```

#### 查看特定課程的修課學生

```
1. 訪問「查詢修課學生名單」頁面
   ↓
2. 在「篩選課程」下拉選單選擇特定課程
   ↓
3. 頁面自動刷新，顯示該課程的修課學生
   ↓
4. 右下出現「編輯此課程成績」按鈕 ✅
```

### 頁面信息

#### 統計卡片
- **總課程數**: 你教授的課程總數
- **修課學生數**: 當前顯示的學生總數
- **已輸入成績**: 已有成績的學生數 (篩選課程時)

#### 學生列表表格

| 欄位 | 說明 |
|------|------|
| # | 序號 |
| 學生名稱 | 學生的全名或用戶名 |
| 學號 | 學生的登入用戶名 |
| 課程 | 課程名稱和代碼 |
| 期中分數 | 期中考試分數 (未填時顯示 --) |
| 期末分數 | 期末考試分數 (未填時顯示 --) |
| 平均分數 | 期中和期末的平均值 (未評分時顯示「未評分」) |

### 範例截圖說明

```
查看所有課程:
─────────────────────────────────────────────
學生名稱    學號      課程            期中  期末  平均
─────────────────────────────────────────────
張三       student1  Python 入門    85   90   87.5
李四       student2  Python 入門    78   82   80.0
王五       student3  Web 開發       92   95   93.5
─────────────────────────────────────────────

篩選後 (Python 入門):
─────────────────────────────────────────────
學生名稱    學號      課程            期中  期末  平均
─────────────────────────────────────────────
張三       student1  Python 入門    85   90   87.5
李四       student2  Python 入門    78   82   80.0
─────────────────────────────────────────────
[編輯此課程成績] 按鈕
```

### 快速操作

篩選特定課程後，可以點擊「編輯此課程成績」按鈕快速進入該課程的成績輸入頁面。

---

## 📊 功能 3: 給學生期中、期末分數

### 訪問方式

**方式一：從學生名單**
1. 進入「查詢修課學生名單」
2. 篩選要編輯的課程
3. 點擊「編輯此課程成績」按鈕

**方式二：從儀表板**
1. 在教師儀表板的課程卡片上點擊「編輯成績」按鈕

**方式三：直接訪問**
```
http://127.0.0.1:8000/teacher/grade_entry/<course_id>/
```

### 功能說明

為特定課程的所有修課學生批量輸入期中、期末分數。

系統特點：
- 📝 **批量編輯**: 一次性編輯一個課程的所有學生成績
- 🔢 **實時計算**: 輸入分數時實時計算平均值
- ✅ **驗證**: 自動驗證分數在 0-100 範圍內
- 💾 **一鍵保存**: 所有修改一起保存，提高效率

### 表單欄位

| 欄位 | 類型 | 說明 |
|------|------|------|
| 期中分數 | 數字輸入 | 0-100，支持小數 (例: 85.5) |
| 期末分數 | 數字輸入 | 0-100，支持小數 (例: 90.0) |
| 平均分數 | 顯示 | 自動計算，不可編輯 |

### 使用步驟

```
1. 進入「成績輸入」頁面
   ↓
2. 看到該課程的所有修課學生列表
   ↓
3. 在「期中分數」欄輸入期中分數
   ↓
4. 在「期末分數」欄輸入期末分數
   ↓
5. 實時計算的平均分數自動更新 ✅
   ↓
6. 點擊「保存所有成績」按鈕
   ↓
7. 返回教師儀表板 ✅
```

### 分數輸入規則

| 規則 | 說明 |
|------|------|
| 範圍 | 0 ~ 100 |
| 小數 | 支持，例: 85.5, 92.3 |
| 空白 | 表示未評分 |
| 混合 | 可只輸入期中或期末其中一個 |

### 平均分數計算

| 情況 | 公式 | 例子 |
|------|------|------|
| 兩個都有 | (期中 + 期末) ÷ 2 | (85 + 90) ÷ 2 = 87.5 |
| 只有期中 | 期中分數 | 85 → 顯示 85.0 |
| 只有期末 | 期末分數 | 90 → 顯示 90.0 |
| 都沒有 | 未評分 | -- |

### 實時計算示例

```
輸入前:
學生名稱    期中    期末    平均
─────────────────────────
張三      [   ]  [   ]   --

輸入期中分數 85:
張三      [ 85 ]  [   ]   85.0

輸入期末分數 90:
張三      [ 85 ]  [ 90 ]  87.5 ✨
```

### 批量輸入範例

假設要為 Python 入門課程輸入期中、期末分數：

```
課程: Python 入門 (CS101)

學生列表:
─────────────────────────────────────────────
# 學生名稱   學號      期中    期末    平均
─────────────────────────────────────────────
1 張三      student1  [85.0] [90.0]  87.5
2 李四      student2  [78.5] [82.0]  80.3
3 王五      student3  [92.0] [95.0]  93.5
─────────────────────────────────────────────
```

點擊「保存所有成績」後，所有分數被保存到資料庫。

### 錯誤處理

| 錯誤 | 原因 | 解決方案 |
|------|------|---------|
| 分數超出範圍 | 輸入 < 0 或 > 100 | 輸入 0-100 之間的值 |
| 非數字輸入 | 輸入非數字字符 | 只輸入數字和小數點 |
| 無課程權限 | 嘗試編輯他人課程 | 只能編輯自己教授的課程 |

### 保存後的驗證

保存成績後，可以通過以下方式驗證：

1. **返回儀表板**: 自動返回，點擊課程卡片的「編輯成績」重新進入
2. **查看學生名單**: 進入「查詢修課學生名單」，篩選課程查看
3. **Django Admin**: 進入管理後台查看 Enrollment 記錄

---

## 📱 教師儀表板變更

教師儀表板現已新增快速操作按鈕：

### 新增的快速操作區

```
┌─────────────────────────────────────────────┐
│         👨‍🏫 教師儀表板 (已升級)             │
├─────────────────────────────────────────────┤
│  [➕ 新增課程]  [👥 查詢修課學生]  [📊 輸入成績]  │
├─────────────────────────────────────────────┤
│  我的課程: 3 | 學生總數: 25 | 總註冊數: 35  │
└─────────────────────────────────────────────┘
```

### 課程卡片增強

每個課程卡片現在包含：
- 課程名稱和代碼
- 課程描述
- 註冊人數
- **新增**: 「查看詳情」按鈕
- **新增**: 「編輯成績」按鈕

---

## 🔄 完整工作流程

### 完整場景: 教師建立課程並輸入成績

#### 第一步: 建立課程

```
教師儀表板
    ↓
點擊「➕ 新增課程」
    ↓
填寫課程名稱: Python 高級程式設計
填寫課程代碼: CS301
填寫課程描述: 學習 Python 進階特性...
    ↓
點擊「新增課程」
    ↓
✅ 課程已建立，返回儀表板
```

#### 第二步: 學生修課

```
學生端:
    ↓
進入「修課系統」
    ↓
選擇「Python 高級程式設計 (CS301)」
    ↓
點擊「修課」
    ↓
✅ 註冊成功
```

#### 第三步: 查看修課名單

```
教師端:
    ↓
點擊「👥 查詢修課學生」
    ↓
篩選「Python 高級程式設計 (CS301)」
    ↓
看到 5 名學生已修課:
  - 張三 (student1)
  - 李四 (student2)
  - 王五 (student3)
  - 趙六 (student4)
  - 孫七 (student5)
```

#### 第四步: 輸入期中、期末分數

```
教師端:
    ↓
點擊「編輯此課程成績」
    ↓
進入「成績輸入」頁面
    ↓
輸入期中分數:
  張三: 85
  李四: 78
  王五: 92
  趙六: 88
  孫七: 95
    ↓
輸入期末分數:
  張三: 90
  李四: 82
  王五: 95
  趙六: 91
  孫七: 98
    ↓
點擊「保存所有成績」
    ↓
✅ 成績已保存，返回儀表板
```

#### 驗證成績已保存

```
進入「查詢修課學生名單」
    ↓
篩選「Python 高級程式設計 (CS301)」
    ↓
看到成績已顯示:
┌─────────────────────────────────────┐
│ 學生名稱  期中  期末  平均          │
├─────────────────────────────────────┤
│ 張三     85   90   87.5 ✅        │
│ 李四     78   82   80.0 ✅        │
│ 王五     92   95   93.5 ✅        │
│ 趙六     88   91   89.5 ✅        │
│ 孫七     95   98   96.5 ✅        │
└─────────────────────────────────────┘
```

---

## 🎯 URL 映射表

| 功能 | URL | 方法 | 說明 |
|------|-----|------|------|
| 新增課程 | `/teacher/add_course/` | GET, POST | 顯示表單 / 建立課程 |
| 查詢學生名單 | `/teacher/student_list/` | GET | 查看修課學生 |
| 查詢學生名單 (篩選) | `/teacher/student_list/?course_id=<id>` | GET | 篩選特定課程 |
| 成績輸入 | `/teacher/grade_entry/<course_id>/` | GET, POST | 顯示表單 / 保存成績 |

---

## 🔒 權限控制

所有功能都受到嚴格的權限控制：

| 操作 | 要求 | 拒絕條件 |
|------|------|---------|
| 新增課程 | 教師角色 | 非教師會顯示錯誤訊息 |
| 查詢學生名單 | 教師角色 | 非教師會顯示錯誤訊息 |
| 輸入成績 | 教師角色 + 課程所有者 | 非教師或非課程授課者會顯示錯誤訊息 |

---

## 💡 使用建議

### 最佳實踐

1. **建立課程時**
   - ✅ 使用明確的課程代碼 (例: CS301 而不是 class1)
   - ✅ 填寫詳細的課程描述
   - ✅ 確保課程代碼唯一性

2. **輸入成績時**
   - ✅ 按順序輸入，避免遺漏
   - ✅ 仔細檢查分數準確性
   - ✅ 一次性保存所有成績

3. **管理課程時**
   - ✅ 定期查看修課人數
   - ✅ 及時輸入成績
   - ✅ 使用篩選功能組織課程

### 常見問題

**Q: 如何修改已輸入的成績？**
A: 進入「成績輸入」頁面，修改分數後點擊「保存所有成績」

**Q: 可以只輸入期中或期末分數嗎？**
A: 可以，系統支持部分填寫，平均分數會相應計算

**Q: 課程代碼能重複嗎？**
A: 不能，系統會驗證唯一性，重複會顯示錯誤

**Q: 可以刪除已建立的課程嗎？**
A: 目前版本不支持直接刪除，請聯繫管理員

---

## 📈 性能考慮

- 批量成績輸入: 支持最多 500 名學生同時輸入
- 篩選功能: 立即刷新，無需手動提交
- 實時計算: 客戶端計算，無伺服器延遲

---

## 🔄 版本歷史

| 版本 | 日期 | 變更 |
|------|------|------|
| 1.0 | 2025-12-30 | 初始發布，新增三個教師功能 |

---

**最後更新**: 2025-12-30  
**功能狀態**: ✅ 完全就緒  
**測試狀態**: ✅ 已驗證
