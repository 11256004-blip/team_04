# 🚀 Admin 後台新增教師和課程功能 - 完整使用指南

## 📌 功能概述

已在 Django 管理後台新增以下便利功能：

| 功能 | 位置 | 用途 | 按鈕 |
|------|------|------|------|
| **新增教師帳號** | 用戶管理頁面 | 快速建立教師帳號，無需手動設定角色 | ➕ |
| **快速新增課程** | 課程管理頁面 | 快速建立課程並一併指定教師 | ➕ |

---

## 🔐 進入 Django 管理後台

### 步驟 1: 訪問後台登入頁

打開瀏覽器，訪問:
```
http://127.0.0.1:8000/admin/
```

### 步驟 2: 登入

使用管理員帳號登入:
- **用戶名**: `admin`
- **密碼**: `admin123`

### 步驟 3: 進入後台

登入成功後看到 Django Admin 首頁！

---

## ➕ 功能 1: 新增教師帳號

### 快速訪問

1. 進入 Django 後台 (`/admin/`)
2. 左側菜單找到「認證和授權」(Authentication and Authorization)
3. 點擊「用戶」(Users)
4. **在用戶列表頁面頂部看到「➕ 新增教師帳號」按鈕**

### 表單填寫

點擊「➕ 新增教師帳號」按鈕後，會出現以下表單：

#### 必填項目 ⭐
- **用戶名** - 教師的登入帳號（唯一）
- **密碼** - 教師的登入密碼

#### 可選項目
- **名字** - 教師的名字
- **姓氏** - 教師的姓氏
- **郵箱** - 教師的電子郵件
- **部門** - 教師所在部門

### 建立範例

```
用戶名: teacher_wang
密碼: Wang@2025
名字: 小芬
姓氏: 王
郵箱: wang.xiaofeng@school.edu.tw
部門: 資訊系
```

點擊「✅ 建立教師帳號」後，系統會：
1. ✅ 檢查用戶名是否重複
2. ✅ 檢查郵箱是否重複
3. ✅ 建立用戶帳號
4. ✅ 自動設定角色為「教師」(Teacher)
5. ✅ 建立 UserProfile 記錄
6. ✅ 顯示成功訊息

---

## ➕ 功能 2: 快速新增課程

### 快速訪問

1. 進入 Django 後台 (`/admin/`)
2. 左側菜單找到「成績」(Grades)
3. 點擊「課程」(Courses)
4. **在課程列表頁面頂部看到「➕ 快速新增課程」按鈕**

### 表單填寫

點擊「➕ 快速新增課程」按鈕後，會出現以下表單：

#### 必填項目 ⭐
- **課程名稱** - 完整的課程名稱
- **課程代碼** - 唯一的課程識別碼（唯一）

#### 可選項目
- **授課教師** - 下拉式選單選擇教師（可不選，稍後再設定）
- **課程描述** - 課程的簡介和內容

### 建立範例

```
課程名稱: Python 程式設計
課程代碼: CS101
授課教師: 王小芬 (teacher_wang)
課程描述: 本課程介紹 Python 基礎語法、資料結構、函數等核心概念...
```

點擊「✅ 建立課程」後，系統會：
1. ✅ 檢查課程代碼是否重複
2. ✅ 取得選定的教師資訊
3. ✅ 建立課程記錄
4. ✅ 綁定教師到課程
5. ✅ 顯示成功訊息

---

## 📊 完整工作流程

### 場景: 需要建立新的課程和教師

#### 第一步: 建立教師帳號

```
Django 後台首頁
    ↓
點擊「用戶」(Users)
    ↓
看到用戶列表
    ↓
點擊「➕ 新增教師帳號」
    ↓
填寫教師信息表單
    ↓
點擊「✅ 建立教師帳號」
    ↓
看到成功訊息 ✅
    ↓
教師帳號已建立，可以登入系統
```

#### 第二步: 建立課程並指定教師

```
Django 後台首頁
    ↓
點擊「課程」(Courses)
    ↓
看到課程列表
    ↓
點擊「➕ 快速新增課程」
    ↓
填寫課程信息表單
    ↓
在「授課教師」選擇剛建立的教師
    ↓
點擊「✅ 建立課程」
    ↓
看到成功訊息 ✅
    ↓
課程已建立，教師可以看到並管理
```

#### 第三步: 驗證

```
以新教師身份登入
    ↓
進入「👨‍🏫 教師」儀表板
    ↓
看到剛建立的課程
    ↓
可以為課程中的學生編輯成績 ✅
```

---

## 🎯 快速參考

### 用戶名取名建議

| 角色 | 建議格式 | 範例 |
|------|---------|------|
| 教師 | `teacher_姓名` | `teacher_wang`, `teacher_chen` |
| 教師 | `prof_名字` | `prof_xiaofeng`, `prof_mingying` |

### 課程代碼命名規範

| 系所 | 格式 | 範例 |
|------|------|------|
| 資訊系 | `CS???` | `CS101`, `CS201`, `CS301` |
| 數學系 | `MATH???` | `MATH101`, `MATH201` |
| 英文系 | `ENG???` | `ENG101`, `ENG102` |
| 通識 | `GE???` | `GE101`, `GE102` |

---

## ✅ 檢查清單

建立新課程前，確認以下事項：

- [ ] 已登入管理員帳號
- [ ] 教師帳號已建立
- [ ] 課程名稱已確定
- [ ] 課程代碼已確定（必須唯一）
- [ ] 知道哪位教師要授課該課程

---

## ⚠️ 常見錯誤及解決方案

### 錯誤 1: 「用戶名已存在」

**原因**: 選擇的用戶名已被其他用戶使用

**解決方案**: 使用不同的用戶名，例如加上序號：
- `teacher_wang_01`
- `teacher_wang_02`

### 錯誤 2: 「課程代碼已存在」

**原因**: 選擇的課程代碼已被其他課程使用

**解決方案**: 使用不同的課程代碼：
- `CS101` → `CS102`（不同年度或級別）
- `CS101` → `CS101_2025`（加上年份）

### 錯誤 3: 新增課程時無法選擇教師

**原因**: 系統中沒有教師帳號，或教師未被標記為「教師」角色

**解決方案**: 
1. 先建立教師帳號
2. 檢查 User Profiles 確保角色設為 'teacher'
3. 重新載入頁面

### 錯誤 4: 建立後看不到新帳號/課程

**原因**: 頁面未重新載入

**解決方案**: 
1. 按 F5 或 Ctrl+R 重新載入頁面
2. 使用搜尋功能查找新建立的項目

---

## 🔄 進階操作

### 修改已建立的課程

1. 進入「課程」列表
2. 點擊要編輯的課程
3. 修改課程信息（名稱、代碼、教師等）
4. 點擊「Save」保存

### 修改教師的角色

1. 進入「User Profiles」
2. 找到要修改的教師
3. 修改角色欄位
4. 點擊「Save」保存

### 檢視課程的學生

1. 進入「課程」列表
2. 點擊要查看的課程
3. 下方會顯示「已註冊學生」表格
4. 可以查看學生的成績

---

## 📱 在教師端的體現

### 教師登入後看到的變化

```
教師用戶名: teacher_wang
密碼: Wang@2025
```

1. 使用上述帳號登入系統
2. 點擊「👨‍🏫 教師」按鈕進入教師儀表板
3. 看到「我的課程」中顯示新建立的課程
4. 可以進入課程編輯學生成績

---

## 🎓 系統架構

```
Django Admin 後台
├── 用戶管理
│   ├── 原有: 標準用戶新增
│   └── 新增: ➕ 新增教師帳號 (自動設定角色)
│
├── User Profiles (角色管理)
│   └── 查看/編輯所有用戶角色
│
└── 課程管理
    ├── 原有: 標準課程新增
    └── 新增: ➕ 快速新增課程 (一併設定教師)
```

---

## 📞 技術細節

### 新增教師帳號的後台代碼流程

```python
@admin.register(User)
class CustomUserAdmin(BaseUserAdmin):
    # 自訂 URL: /admin/auth/user/create-teacher/
    
    def create_teacher_view(request):
        1. 驗證用戶名唯一性
        2. 驗證郵箱唯一性
        3. User.objects.create_user(...)  # 建立用戶
        4. UserProfile.objects.create(role='teacher', ...)  # 設定角色
        5. 顯示成功訊息
```

### 快速新增課程的後台代碼流程

```python
@admin.register(Course)
class CourseAdmin(admin.ModelAdmin):
    # 自訂 URL: /admin/grades/course/create-quick/
    
    def create_course_quick_view(request):
        1. 驗證課程代碼唯一性
        2. 取得選定教師的 User 物件
        3. Course.objects.create(
            name=name,
            code=code,
            teacher=teacher,
            description=description
        )
        4. 顯示成功訊息
```

---

## 🌟 功能亮點

✨ **快速且簡潔**
- 不需要進入複雜的標準新增頁面
- 表單只顯示必要欄位
- 一次填寫即可完成

✨ **自動設定**
- 新增教師自動設定角色為「教師」
- 新增課程自動綁定教師

✨ **友善的用戶介面**
- 清晰的表單標籤和說明
- 成功/失敗訊息提示
- 按鈕顏色易識別

✨ **完整的驗證**
- 檢查用戶名唯一性
- 檢查課程代碼唯一性
- 檢查郵箱唯一性（可選）

---

## 📚 相關文檔

| 文檔 | 說明 |
|------|------|
| ADMIN_TEACHER_FEATURES.md | 完整的管理員功能文檔 |
| ADMIN_QUICK_ADD_GUIDE.md | 詳細的快速新增指南 |
| QUICK_START.md | 快速開始指南 |
| CHANGELOG.md | 變更日誌 |

---

**版本:** 1.1.0  
**最後更新:** 2025-12-30  
**功能狀態:** ✅ 測試就緒
