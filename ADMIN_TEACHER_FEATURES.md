# æˆç¸¾ç³»çµ± - ç®¡ç†å“¡èˆ‡æ•™å¸«åŠŸèƒ½æ–‡ä»¶

## ğŸ¯ åŠŸèƒ½æ¦‚è¦½

æœ¬ç³»çµ±å·²é›†æˆå®Œæ•´çš„è§’è‰²ç®¡ç†ç³»çµ±ï¼ŒåŒ…æ‹¬ï¼š
- **ğŸ‘¤ å­¸ç”Ÿ (Student)**: æŸ¥çœ‹è‡ªå·±çš„èª²ç¨‹å’Œæˆç¸¾
- **ğŸ‘¨â€ğŸ« æ•™å¸« (Teacher)**: ç®¡ç†èª²ç¨‹å’Œç·¨è¼¯å­¸ç”Ÿæˆç¸¾
- **ğŸ” ç®¡ç†å“¡ (Admin)**: ç®¡ç†æ‰€æœ‰ç”¨æˆ¶ã€èª²ç¨‹å’Œç³»çµ±è¨­å®š

---

## ğŸ“š æ¨¡å‹çµæ§‹

### UserProfile æ¨¡å‹
ç”¨æˆ¶è§’è‰²ç³»çµ±ï¼Œæ“´å±• Django å…§å»º User æ¨¡å‹ï¼š

```python
class UserProfile(models.Model):
    user = OneToOneField(User)
    role = CharField(choices=[('student', 'Student'), ('teacher', 'Teacher'), ('admin', 'Admin')])
    department = CharField()  # éƒ¨é–€
```

### Course æ¨¡å‹ï¼ˆå·²æ›´æ–°ï¼‰
- `teacher`: ForeignKey æŒ‡å‘æ•™å¸«ç”¨æˆ¶
- `description`: èª²ç¨‹æè¿°
- `created_at`, `updated_at`: æ™‚é–“æˆ³

### Enrollment æ¨¡å‹
- ä¿æŒåŸæœ‰çµæ§‹ï¼Œç”¨æ–¼è¿½è¹¤å­¸ç”Ÿè¨»å†Š

---

## ğŸš€ å¿«é€Ÿé–‹å§‹

### 1. å»ºç«‹æ¸¬è©¦ç”¨æˆ¶

é‹è¡Œä»¥ä¸‹å‘½ä»¤è‡ªå‹•å»ºç«‹æ¸¬è©¦å¸³æˆ¶ï¼š

```bash
.\.venv\Scripts\python.exe manage.py create_test_users
```

æˆ–ä½¿ç”¨ç³»çµ± Pythonï¼ˆå¦‚å·²å®‰è£ï¼‰ï¼š

```bash
python manage.py create_test_users
```

### é è¨­æ¸¬è©¦å¸³æˆ¶

| è§’è‰² | ç”¨æˆ¶å | å¯†ç¢¼ | èªªæ˜ |
|------|--------|------|------|
| **ç®¡ç†å“¡** | `admin` | `admin123` | ç³»çµ±ç®¡ç†å“¡ |
| **æ•™å¸«** | `teacher1` | `teacher123` | è³‡è¨Šç³»æ•™å¸« |
| **æ•™å¸«** | `teacher2` | `teacher123` | æ•¸å­¸ç³»æ•™å¸« |
| **å­¸ç”Ÿ** | `student1-4` | `student123` | æ¸¬è©¦å­¸ç”Ÿ |

### 2. å•Ÿå‹•é–‹ç™¼ä¼ºæœå™¨

```bash
.\.venv\Scripts\python.exe manage.py runserver
```

ä¼ºæœå™¨å•Ÿå‹•å¾Œï¼Œè¨ªå•: `http://127.0.0.1:8000`

---

## ğŸ‘¨â€ğŸ’¼ ç®¡ç†å“¡åŠŸèƒ½

### è¨ªå•ç®¡ç†å“¡å„€è¡¨æ¿

1. ç™»å…¥å¸³æˆ¶: `admin` / `admin123`
2. é»é¸å°è¦½åˆ—çš„ã€ŒğŸ” ç®¡ç†å“¡ã€æŒ‰éˆ•
3. æˆ–ç›´æ¥è¨ªå•: `http://127.0.0.1:8000/main/admin/dashboard/`

### ç®¡ç†å“¡åŠŸèƒ½æ¸…å–®

| åŠŸèƒ½ | URL | èªªæ˜ |
|------|-----|------|
| å„€è¡¨æ¿ | `/main/admin/dashboard/` | æŸ¥çœ‹ç³»çµ±çµ±è¨ˆå’Œæœ€è¿‘æ´»å‹• |
| ç®¡ç†ä½¿ç”¨è€… | `/main/admin/users/` | æŸ¥çœ‹æ‰€æœ‰ç”¨æˆ¶åˆ—è¡¨ |
| ç”¨æˆ¶è©³æƒ… | `/main/admin/user/<id>/` | æŸ¥çœ‹å–®å€‹ç”¨æˆ¶ä¿¡æ¯å’Œè¨»å†Šèª²ç¨‹ |
| ç®¡ç†èª²ç¨‹ | `/main/admin/courses/` | æŸ¥çœ‹æ‰€æœ‰èª²ç¨‹ |
| èª²ç¨‹è©³æƒ… | `/main/admin/course/<id>/` | æŸ¥çœ‹èª²ç¨‹ä¿¡æ¯å’Œå·²è¨»å†Šå­¸ç”Ÿ |

### ç®¡ç†å“¡å„€è¡¨æ¿é é¢èªªæ˜

- **çµ±è¨ˆå¡ç‰‡**: é¡¯ç¤ºå­¸ç”Ÿæ•¸ã€æ•™å¸«æ•¸ã€èª²ç¨‹æ•¸ã€è¨»å†Šæ•¸
- **æœ€è¿‘çš„è¨»å†Š**: é¡¯ç¤ºæœ€è¿‘ 10 å€‹è¨»å†Šè¨˜éŒ„
- **å¿«é€Ÿé€£çµ**: é€£çµåˆ°ç”¨æˆ¶ç®¡ç†ã€èª²ç¨‹ç®¡ç†ã€Django å¾Œå°

---

## ğŸ‘¨â€ğŸ« æ•™å¸«åŠŸèƒ½

### è¨ªå•æ•™å¸«å„€è¡¨æ¿

1. ç™»å…¥å¸³æˆ¶: `teacher1` æˆ– `teacher2` (å¯†ç¢¼: `teacher123`)
2. é»é¸å°è¦½åˆ—çš„ã€ŒğŸ‘¨â€ğŸ« æ•™å¸«ã€æŒ‰éˆ•
3. æˆ–ç›´æ¥è¨ªå•: `http://127.0.0.1:8000/main/teacher/dashboard/`

### æ•™å¸«åŠŸèƒ½æ¸…å–®

| åŠŸèƒ½ | URL | èªªæ˜ |
|------|-----|------|
| å„€è¡¨æ¿ | `/main/teacher/dashboard/` | æŸ¥çœ‹è‡ªå·±çš„èª²ç¨‹å’Œçµ±è¨ˆ |
| èª²ç¨‹ç®¡ç† | `/main/teacher/course/<id>/` | ç®¡ç†ç‰¹å®šèª²ç¨‹å’Œå­¸ç”Ÿæˆç¸¾ |
| ç·¨è¼¯æˆç¸¾ | `/main/teacher/update_grade/<enrollment_id>/` | æ›´æ–°å­¸ç”Ÿæˆç¸¾ï¼ˆPOSTï¼‰ |

### æ•™å¸«å„€è¡¨æ¿é é¢èªªæ˜

- **çµ±è¨ˆå¡ç‰‡**: é¡¯ç¤ºè‡ªå·±çš„èª²ç¨‹æ•¸ã€æ•™å°å­¸ç”Ÿæ•¸ã€ç¸½è¨»å†Šæ•¸
- **æˆ‘çš„èª²ç¨‹**: å¡ç‰‡å¼é¡¯ç¤ºæ‰€æœ‰æˆèª²èª²ç¨‹
- **èª²ç¨‹å¡ç‰‡**: æ¯å¼µå¡ç‰‡é¡¯ç¤ºèª²ç¨‹åç¨±ã€ä»£ç¢¼ã€æè¿°å’Œå­¸ç”Ÿæ•¸

### ç·¨è¼¯å­¸ç”Ÿæˆç¸¾

1. é€²å…¥èª²ç¨‹ç®¡ç†é é¢
2. åœ¨ã€Œå­¸ç”Ÿæˆç¸¾ã€è¡¨æ ¼ä¸­æ‰¾åˆ°å­¸ç”Ÿ
3. åœ¨ã€ŒæœŸä¸­æˆç¸¾ã€æˆ–ã€ŒæœŸæœ«æˆç¸¾ã€æ¬„ä½è¼¸å…¥åˆ†æ•¸
4. é»é¸ã€ŒğŸ’¾ã€æŒ‰éˆ•ä¿å­˜
5. ç³»çµ±æœƒè‡ªå‹•è¨ˆç®—å¹³å‡æˆç¸¾ï¼ˆæœŸä¸­å’ŒæœŸæœ«çš„å¹³å‡å€¼ï¼‰

---

## ğŸ“– æŠ€è¡“å¯¦ç¾ç´°ç¯€

### è·¯ç”± (urls.py)

```python
# ç®¡ç†å“¡è·¯ç”±
path('admin/dashboard/', views.admin_dashboard, name='admin_dashboard')
path('admin/users/', views.admin_users, name='admin_users')
path('admin/user/<int:user_id>/', views.admin_user_detail, name='admin_user_detail')
path('admin/courses/', views.admin_courses, name='admin_courses')
path('admin/course/<int:course_id>/', views.admin_course_detail, name='admin_course_detail')

# æ•™å¸«è·¯ç”±
path('teacher/dashboard/', views.teacher_dashboard, name='teacher_dashboard')
path('teacher/course/<int:course_id>/', views.teacher_course_detail, name='teacher_course_detail')
path('teacher/update_grade/<int:enrollment_id>/', views.teacher_update_grade, name='teacher_update_grade')
```

### æ¬Šé™æª¢æŸ¥

æ‰€æœ‰ç®¡ç†å“¡å’Œæ•™å¸«è¦–åœ–éƒ½åŒ…å«æ¬Šé™æª¢æŸ¥ï¼š

```python
def _is_admin(user):
    """æª¢æŸ¥ç”¨æˆ¶æ˜¯å¦ç‚ºç®¡ç†å“¡"""
    if not user.is_authenticated:
        return False
    return hasattr(user, 'profile') and user.profile.role == 'admin'

def _is_teacher(user):
    """æª¢æŸ¥ç”¨æˆ¶æ˜¯å¦ç‚ºæ•™å¸«"""
    if not user.is_authenticated:
        return False
    return hasattr(user, 'profile') and user.profile.role == 'teacher'
```

- æœªæˆæ¬Šç”¨æˆ¶å°‡æ”¶åˆ° 403 Forbidden éŸ¿æ‡‰
- æ•™å¸«åªèƒ½ç·¨è¼¯è‡ªå·±æˆèª²çš„èª²ç¨‹

### è¡¨æ ¼è¨­è¨ˆ

#### UserProfile (ç”¨æˆ¶è§’è‰²)
- `id`: ä¸»éµ
- `user`: ä¸€å°ä¸€é—œä¿‚åˆ° User æ¨¡å‹
- `role`: è§’è‰²ï¼ˆstudent/teacher/adminï¼‰
- `department`: éƒ¨é–€åç¨±
- `created_at`: å»ºç«‹æ™‚é–“
- `updated_at`: æœ€å¾Œæ›´æ–°æ™‚é–“

#### Course (èª²ç¨‹) - æ›´æ–°
- `teacher`: æ•™å¸«ç”¨æˆ¶ï¼ˆForeignKeyï¼‰
- `description`: èª²ç¨‹æè¿°
- `created_at`, `updated_at`: æ™‚é–“æˆ³

---

## ğŸ“ ä½¿ç”¨æ¡ˆä¾‹

### æ¡ˆä¾‹ 1: ç®¡ç†å“¡æ–°å¢æ•™å¸«å’Œèª²ç¨‹

1. ä»¥ `admin` èº«ä»½ç™»å…¥
2. é€²å…¥ã€Œç®¡ç†ä½¿ç”¨è€…ã€æŸ¥çœ‹æ‰€æœ‰ç”¨æˆ¶
3. ç·¨è¼¯ç”¨æˆ¶è§’è‰²ï¼ˆé€é Django å¾Œå° `/admin/`ï¼‰
4. é€²å…¥ã€Œç®¡ç†èª²ç¨‹ã€æ–°å¢èª²ç¨‹
5. é¸æ“‡æ•™å¸«ä½œç‚ºèª²ç¨‹è² è²¬äºº

### æ¡ˆä¾‹ 2: æ•™å¸«ç·¨è¼¯å­¸ç”Ÿæˆç¸¾

1. ä»¥ `teacher1` èº«ä»½ç™»å…¥
2. é€²å…¥ã€ŒğŸ‘¨â€ğŸ« æ•™å¸«ã€å„€è¡¨æ¿
3. é»é¸è¦ç®¡ç†çš„èª²ç¨‹
4. åœ¨è¡¨æ ¼ä¸­ç‚ºæ¯å€‹å­¸ç”Ÿè¼¸å…¥æœŸä¸­å’ŒæœŸæœ«æˆç¸¾
5. é»é¸ã€ŒğŸ’¾ã€ä¿å­˜

### æ¡ˆä¾‹ 3: å­¸ç”ŸæŸ¥çœ‹æˆç¸¾

1. ä»¥ `student1` èº«ä»½ç™»å…¥
2. é€²å…¥ã€ŒğŸ“š æˆ‘çš„èª²ç¨‹ã€é é¢
3. æŸ¥çœ‹å·²è¨»å†Šèª²ç¨‹åŠæˆç¸¾
4. æŸ¥çœ‹èª²ç¨‹å¹³å‡æˆç¸¾

---

## ğŸ› æ•…éšœæ’é™¤

### å•é¡Œ 1: ç„¡æ³•å­˜å–ç®¡ç†å“¡é é¢

**åŸå› **: ç”¨æˆ¶æ²’æœ‰è¢«è¨­å®šç‚ºç®¡ç†å“¡è§’è‰²

**è§£æ±ºæ–¹æ¡ˆ**:
1. é€²å…¥ Django å¾Œå° (`/admin/`)
2. é€²å…¥ã€ŒUser Profilesã€
3. ç·¨è¼¯ç”¨æˆ¶çš„ role ç‚º "admin"

### å•é¡Œ 2: æ•™å¸«ç„¡æ³•ç·¨è¼¯èª²ç¨‹

**åŸå› **: æ•™å¸«æ²’æœ‰è¢«åˆ†é…è©²èª²ç¨‹

**è§£æ±ºæ–¹æ¡ˆ**:
1. é€²å…¥ Django å¾Œå°
2. ç·¨è¼¯ Courseï¼Œå°‡ teacher è¨­å®šç‚ºè©²æ•™å¸«

### å•é¡Œ 3: é¡¯ç¤º"æœªè¨­å®š"çš„è§’è‰²

**åŸå› **: ç”¨æˆ¶æ²’æœ‰é—œè¯çš„ UserProfile

**è§£æ±ºæ–¹æ¡ˆ**:
1. é€²å…¥ Django å¾Œå°
2. é€²å…¥ã€ŒUser Profilesã€
3. å»ºç«‹æ–° profile é—œè¯åˆ°è©²ç”¨æˆ¶

---

## ğŸ“ å¸¸è¦‹æ“ä½œ

### å»ºç«‹æ–°ç”¨æˆ¶

**é€é Django å¾Œå°**:
1. è¨ªå• `http://127.0.0.1:8000/admin/`
2. é€²å…¥ã€ŒUsersã€
3. é»é¸ã€ŒAdd Userã€

**é€éå‘½ä»¤åˆ—**:
```bash
.\.venv\Scripts\python.exe manage.py createsuperuser  # å»ºç«‹è¶…ç´šç”¨æˆ¶
```

### å»ºç«‹æ–°èª²ç¨‹

1. ä»¥ç®¡ç†å“¡èº«ä»½ç™»å…¥
2. é€²å…¥ã€Œç®¡ç†èª²ç¨‹ã€
3. é»é¸ã€Œæ–°å¢èª²ç¨‹ã€
4. å¡«å¯«èª²ç¨‹ä¿¡æ¯ä¸¦é¸æ“‡æ•™å¸«

### è¨»å†Šå­¸ç”Ÿåˆ°èª²ç¨‹

1. ç™»å…¥å­¸ç”Ÿå¸³æˆ¶
2. é€²å…¥ã€ŒğŸ“š æˆ‘çš„èª²ç¨‹ã€
3. é»é¸ã€Œé¸èª²ã€
4. é¸æ“‡èª²ç¨‹ä¸¦ç¢ºèª

---

## ğŸ” å®‰å…¨å»ºè­°

> âš ï¸ **ç”Ÿç”¢ç’°å¢ƒæ³¨æ„**:
> - ä¿®æ”¹æ‰€æœ‰é»˜èªå¯†ç¢¼
> - è¨­å®š `DEBUG = False`
> - ä½¿ç”¨ç’°å¢ƒè®Šæ•¸ç®¡ç†æ•æ„Ÿä¿¡æ¯
> - é…ç½® ALLOWED_HOSTS
> - ä½¿ç”¨ HTTPS
> - å®šæœŸå‚™ä»½è³‡æ–™åº«

---

## ğŸ“ æ”¯æ´èˆ‡åé¥‹

å¦‚æœ‰ä»»ä½•å•é¡Œæˆ–å»ºè­°ï¼Œè«‹è¯ç¹«ç³»çµ±ç®¡ç†å“¡æˆ–æäº¤å•é¡Œå ±å‘Šã€‚

---

**æœ€å¾Œæ›´æ–°**: 2025å¹´12æœˆ30æ—¥
**ç‰ˆæœ¬**: 1.0.0
