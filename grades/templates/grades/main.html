{% extends 'grades/base.html' %}

{% block content %}
  {% if message %}
    <div class="message error">
      âš ï¸ {{ message }}
    </div>
  {% endif %}

  {% if student %}
    <h2>ğŸ‘¨â€ğŸ“ {{ student.username }} çš„ä¿®èª²è³‡æ–™</h2>
    
    <div class="btn-group">
      <a href="{% url 'grades:add_course' %}" class="btn">â• æ–°å¢èª²ç¨‹</a>
      <a href="{% url 'grades:enroll' %}" class="btn btn-secondary">ğŸ“ åŠ é¸èª²ç¨‹</a>
    </div>

    <h3>ğŸ“– ä¿®èª²åˆ—è¡¨</h3>
    {% if enrollments %}
      <table>
        <thead>
          <tr>
            <th>èª²ç¨‹åç¨±</th>
            <th style="text-align: center;">æœŸä¸­æˆç¸¾</th>
            <th style="text-align: center;">æœŸæœ«æˆç¸¾</th>
            <th style="text-align: center;">å¹³å‡</th>
            <th style="text-align: center;">æ“ä½œ</th>
          </tr>
        </thead>
        <tbody>
          {% for e in enrollments %}
            <tr>
              <td>
                <a href="{% url 'grades:course_detail' e.course.id %}">
                  ğŸ“š {{ e.course.name }}
                </a>
              </td>
              <td style="text-align: center;">
                {% if e.midterm_score %}
                  <strong>{{ e.midterm_score }}</strong>
                {% else %}
                  <span style="color: #999;">-</span>
                {% endif %}
              </td>
              <td style="text-align: center;">
                {% if e.final_score %}
                  <strong>{{ e.final_score }}</strong>
                {% else %}
                  <span style="color: #999;">-</span>
                {% endif %}
              </td>
              <td style="text-align: center;">
                {% if e.average %}
                  <strong style="color: #667eea;">{{ e.average|floatformat:2 }}</strong>
                {% else %}
                  <span style="color: #999;">-</span>
                {% endif %}
              </td>
              <td style="text-align: center;">
                <a href="{% url 'grades:unenroll' e.id %}" class="btn btn-danger btn-small" 
                   onclick="return confirm('ç¢ºå®šè¦é€€é¸ã€Œ{{ e.course.name }}ã€å—ï¼Ÿ')">
                  âŒ é€€é¸
                </a>
              </td>
            </tr>
          {% endfor %}
        </tbody>
      </table>

      <div class="stats-card">
        <h4>ğŸ“Š å­¸æœŸç¸½æˆç¸¾</h4>
        <div class="stats-value">
          {% if overall_avg %}
            {{ overall_avg|floatformat:2 }} åˆ†
          {% else %}
            å°šç„¡æˆç¸¾
          {% endif %}
        </div>
      </div>
    {% else %}
      <div class="empty-state">
        <div class="empty-state-icon">ğŸ“­</div>
        <p style="font-size: 1.2em; color: #666;">å°šç„¡ä¿®èª²ç´€éŒ„</p>
        <p>é»æ“Šä¸Šæ–¹ã€ŒåŠ é¸èª²ç¨‹ã€é–‹å§‹é¸èª²å§ï¼</p>
      </div>
    {% endif %}
  {% else %}
    <div class="empty-state">
      <div class="empty-state-icon">ğŸ‘‹</div>
      <h2>æ­¡è¿ä½¿ç”¨æˆç¸¾ç³»çµ±</h2>
      <p>è«‹å…ˆå»ºç«‹ä½¿ç”¨è€…èˆ‡èª²ç¨‹è³‡æ–™ã€‚</p>
    </div>
  {% endif %}
{% endblock %}
